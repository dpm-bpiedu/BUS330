!function(){"use strict";var e={getStrings:function(e,t){var a={},n=e.indexOf(t);return a.string1=e.slice(0,n),a.string2=e.slice(n+1),a},isNumber:function(e,t){return!isNaN(t.charAt(e))},newEl:{empty:function(t,a){var n=document.createElement(t);return e.setAttributes(n,a),n},wText:function(t,a,n){var r=document.createElement(t),i=document.createTextNode(a);return e.setAttributes(r,n),r.appendChild(i),r},wChildren:function(t,a,n){var r=document.createElement(t);e.setAttributes(r,n);for(var i=0;i<a.length;i++)r.appendChild(a[i]);return r}},setAttributes:function(e,t){Object.keys(t).forEach(function(a){e.setAttribute(a,t[a])})}},t={container:document.getElementById("printTOC"),headObjects:[],makeHeading:function(t,a){var n=e.newEl.wText("a",t,a);return e.newEl.wChildren("li",[n],{class:"toc_item"})},makeTOC:function(){a.extract();for(var n=e.newEl.wText("h1","Brief Contents",{class:"h1"}),r=e.newEl.wChildren("nav",[n],{class:"briefNav"}),i=e.newEl.empty("ul",{id:"briefList"}),s=e.newEl.wText("h1","Contents",{class:"h1"}),c=e.newEl.wChildren("nav",[s],{class:"briefNav"}),d=e.newEl.empty("ul",{id:"detailList"}),l=0;l<this.headObjects.length;l++){var h=this.headObjects[l];h.detailOnly?d.appendChild(t.makeHeading(h.text,{class:h.type,href:h.href})):(i.appendChild(t.makeHeading(h.text,{class:h.type,href:h.href})),d.appendChild(t.makeHeading(h.text,{class:h.type,href:h.href})))}r.appendChild(i),c.appendChild(d),this.container.appendChild(r),this.container.appendChild(c)}},a={extract:function(){var e,t=document.querySelectorAll("[data-toc]");for(e=0;e<t.length;e++)a.handle(t[e],e)},handle:function(a,n){var r={};switch(a.setAttribute("id","toc_"+(n+1)),r.type=a.getAttribute("data-toc"),r.href="#toc_"+(n+1),r.type){case"ch-title":var i=a.querySelector("[data-ch-title=number]"),s=a.querySelector("[data-ch-title=text]");r.detailOnly=!1,r.number="Chapter "+i.textContent,r.text=r.number+" "+s.textContent,i.insertAdjacentHTML("afterbegin",'<span class="hidden">Chapter </span>'),i.setAttribute("data-head","tl"),s.setAttribute("data-head","tr");break;case"ch-h1":case"ch-h1-eoc":var c,d,l,h,u;c=a.textContent,r.detailOnly=!1,e.isNumber(0,c)?(r.hasNumber=!0,l=(d=e.getStrings(c," ")).string1+" ",h=d.string2,r.text=c,u="<span data-head='tl'><span class='hidden'>Section </span>"+l+"</span> <span data-head='tr'>"+h+"</span>"):(r.hasNumber=!1,r.text=c,u="<span class='hidden' data-head='tl'></span><span data-head='tr'>"+r.text+"</span>"),a.innerHTML=u;break;case"fm-h1":case"bm-h1":r.detailOnly=!1,r.text=a.textContent;break;case"ch-h2":case"ch-h2-eoc":case"fm-h2":case"bm-h2":r.detailOnly=!0,r.text=a.textContent;break;default:console.log("ERROR: incorrect data attribute",a.type)}t.headObjects.push(r)}};t.makeTOC()}();